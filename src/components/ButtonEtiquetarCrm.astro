---
import '../styles/global.css';
---

<div class="flex flex-col items-center justify-center p-6 bg-white rounded-lg shadow-lg max-w-sm mx-auto mt-6 border border-gray-200">
  <h3 class="mb-3 text-purple-700 text-lg font-bold">Recalcular Métricas</h3>
  <p class="mb-4 text-gray-600 text-sm text-center">Haz clic en el botón para etiquetar los clientes en el CRM -> GHL.</p>
  <button
    id="recalcularBtn"
    class="px-5 py-2 bg-gradient-to-r from-purple-500 to-pink-400 text-white rounded-md text-sm font-medium shadow-md hover:from-purple-600 hover:to-pink-500 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-300"
  >
    Etiquetar en GHL
  </button>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('recalcularBtn');
    if (btn) {
      btn.addEventListener('click', async () => {
        try {
          const res = await fetch('https://kukulcanai.app.n8n.cloud/webhook/etiquetar-clientes', {
            method: 'GET'
          });
          if (res.ok) {
            alert('Recalculo realizado correctamente');
          } else {
            alert('Error al recalcular');
          }
        } catch (e) {
          alert('Error de conexión');
        }
      });
    } else {
      console.error('El botón no se encontró en el DOM.');
    }
  });
</script>
